define(["backbone","com/ericmatthys/models/PlayerModel","text!templates/seekbar.html"],function(a,b,c){var d="emp-seek-bar",e="emp-buffer-bar",f="emp-progress-bar",g="emp-progress-thumb",h=a.View.extend({el:"."+d,model:b.video,events:{mousedown:"onSeekBarMouseDown"},initialize:function(){_.bindAll(this,"onSeekBarMouseMove","onSeekBarMouseUp"),this.model.bind("change:formattedTime",this.onCurrentTimeChange,this),this.model.bind("change:startBuffer",this.onBufferChange,this),this.model.bind("change:endBuffer",this.onBufferChange,this)},render:function(){return this.$el.html(_.template(c,{})),this.onCurrentTimeChange(),this.onBufferChange(),this},seek:function(a){var c=$("."+d),e=a-c.offset().left,f=e/c.width(),g=f*b.video.get("duration");this.trigger("seek",g)},onSeekBarMouseDown:function(a){a.preventDefault(),$(document).bind("mousemove",this.onSeekBarMouseMove),$(document).bind("mouseup",this.onSeekBarMouseUp),this.seek(a.pageX)},onSeekBarMouseMove:function(a){a.preventDefault(),this.seek(a.pageX)},onSeekBarMouseUp:function(a){a.preventDefault(),$(document).unbind("mousemove",this.onSeekBarMouseMove),$(document).unbind("mouseup",this.onSeekBarMouseUp),this.seek(a.pageX)},onCurrentTimeChange:function(){var a=$("."+d).width(),c=b.video.get("currentTime")/b.video.get("duration"),e=c*a;e<4?e=4:e+4>a&&(e=a-4),$("."+f).width(e),$("."+g).css("left",e-4)},onBufferChange:function(){var a=$("."+e),c=$("."+d).width(),f=b.video.get("duration"),g=b.video.get("startBuffer")/f,h=b.video.get("endBuffer")/f,i=g*c,j=h*c-i;a.css("left",i),a.width(j)}});return h})